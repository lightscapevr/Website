{% extends "layouts/layout-base.html" %}

{% block custom_style_imports %}
{% endblock custom_style_imports %}

{% block nav_menu_items %}
<li class="nav-item">
    <a class="nav-link" href="index.html">Home</a>
</li>
<li class="nav-item">
    <a class="nav-link" href="docs-getting-started.html">Documentation</a>
</li>
<li class="nav-item">
    <a class="nav-link" href="faqs.html">FAQs</a>
</li>
<li class="nav-item">
    <a class="nav-link" href="tutorials.html">Tutorials</a>
</li>
{% endblock nav_menu_items %}

{% block main_content %}
{% raw %}

<div class="container">
    <div id="cloud-app">
        <h2>Active file</h2>
        <p>Logged in as: {{user_name}}.&nbsp; Connection status: {{connection_status}}</p>
        <div v-if="active_file !== false">
            <active-file v-bind:file="active_file" />
        </div>
        <div v-else>
            <p>No active file. Please select one from the list below...</p>
        </div>




        <h2>Your files</h2>
        <cloud-file-list v-bind:files="files"></cloud-file-list>
        <notification-bar v-bind:notification="notification" v-bind:close="hide_notification">
    </div>
</div>

<script type="text/x-template" id="notification-bar">
    <div>
        <div v-show="notification.show">
            <div class="alert fixed-bottom" :class="notification.type" role="alert">
                {{notification.message}}
                <button v-on:click="close">x</button>
            </div>
        </div>
    </div>
</script>

<script type="text/x-template" id="active-file">
    <div>
        <h4>name: {{file.name}}</h4>
        <p>name: {{file.description}}</p>
        <button v-on:click="remove_active_file">Remove</button>
    </div>
</script>

<script type="text/x-template" id="cloud-file-list">
    <div>
        <div class="row">
           <div class="col">
                <button v-on:click="order_by_name" class="btn btn-outline-secondary">Name</button>                   
           </div>
           <div class="col">
                <button v-on:click="order_by_size" class="btn btn-outline-secondary">Size</button>
            </div>
            <div class="col">
                <button v-on:click="order_by_date" class="btn btn-outline-secondary">Date Modified</button>
            </div>
            <div class="col">
            </div>
        </div>

        <div v-for="file in files">
            <cloud-file 
            :key="file.id" 
            v-bind:file="file"
            ></cloud-file>
        </div>
    </div>
</script>


<script type="text/x-template" id="cloud-file">
    <div>
        <div class="row c-file">
            <div class="col">
                <strong>{{file.name}}</strong>
                <p>{{file.description}}</P>
            </div>
            <div class="col">
                    {{file.size}}
            </div>
            <div class="col">
                    {{file.date_modified}}
            </div>
            <div class="col">
                <button v-on:click="send_file_to_vr" class="btn btn-outline-primary">Send to VR</button>
                <button v-on:click="toggle_details_tabs" class="btn btn-light">Details</button>
            </div>
        </div>
        <component
            v-bind:is="current_tab"

            v-bind:file_name="file.name"
            v-bind:file_description="file.description"

            v-bind:sharable_link="file.sharable_link"
            v-bind:id="file.id"

            v-on:change-tab="on_change_tab"
            v-on:save-edit="on_save_edit"
            v-on:delete-file="on_delete_file"
            v-on:share="on_share"
      ></component>
    </div>
</script>

<script type="text/x-template" id="cloud-file-details">
    <div class="row">
        <button v-on:click="$emit('change-tab','cloud-file-share')" class="btn btn-primary">Share</button>
        <button v-on:click="$emit('change-tab','cloud-file-edit')" class="btn btn-light">Edit</button>
        <button v-on:click="$emit('change-tab','cloud-file-delete')" class="btn btn-light">Delete</button>
        <button v-on:click="$emit('change-tab','')" class="btn btn-light">Close Details</button>
    </div>
</script>

<script type="text/x-template" id="cloud-file-edit">
    <div class="row">
        <input v-model="new_name" placeholder="Edit name...">
        <input v-model="new_description" placeholder="Edit dicription...">
        <button v-on:click="$emit('save-edit',{name:new_name,description:new_description})" class="btn btn-primary">Save</button>
        <button v-on:click="$emit('change-tab','cloud-file-details')" class="btn btn-light">Cancel</button>
    </div>
</script>

<script type="text/x-template" id="cloud-file-delete">
    <div class="row">
        <button v-on:click="$emit('delete-file')" class="btn btn-danger">Delete</button>
        <button v-on:click="$emit('change-tab','cloud-file-details')" class="btn btn-light">Cancel</button>
    </div>
</script>

<script type="text/x-template" id="cloud-file-share">
    <div class="row">
       <input type="text" v-bind:value="sharable_link" :id="'share-link-'+id" readonly>
       <button v-on:click="$emit('share')" class="btn btn-primary">Copy link to clipboard</button>
       <button v-on:click="$emit('change-tab','cloud-file-details')" class="btn btn-light">Close</button>
    </div>
</script>

{% endraw %}
{% endblock main_content %}

{% block js_imports %}
<script src="js/libraries/vue.js"></script>
<script src="js/cloudApp.js"></script>
{% endblock js_imports %}